# `tcp/ip` 3 次握手, 4 次挥手

[“三次握手，四次挥手”你真的懂吗？](https://zhuanlan.zhihu.com/p/`53374516`)

**3 次握手:**

1. 客户端发送一个 `SYN` 段，并指明客户端的初始序列号，即 `ISN(c)`.
2. 服务端发送自己的 `SYN` 段作为应答，同样指明自己的 `ISN(s)`。为了确认客户端的 `SYN`，将 `ISN(c)+1` 作为 `ACK` 数值。这样，每发送一个 `SYN`，序列号就会加 1. 如果有丢失的情况，则会重传。
3. 为了确认服务器端的 `SYN`，客户端将 `ISN(s)+1` 作为返回的 `ACK` 数值。

**4 次挥手:**

1. 客户端发送一个 `FIN` 段，并包含一个希望接收者看到的自己当前的序列号 `K`. 同时还包含一个 `ACK` 表示确认对方最近一次发过来的数据。
2. 服务端将 `K` 值加 1 作为 `ACK` 序号值，表明收到了上一个包。这时上层的应用程序会被告知另一端发起了关闭操作，通常这将引起应用程序发起自己的关闭操作。
3. 服务端发起自己的 `FIN` 段，`ACK=K+1`, `Seq=L`
4. 客户端确认。`ACK=L+1`

**缩写:**

`URG`：(`URGent`)紧急
`ACK`：(`Acknowledge character`)确认
`PSH`：(`PuSH`)推送
`RST`：(`ReSeT`)复位
`SYN`：(`SYNchronization`) 同步
`FIN`:（`FINish`）终止
`ISN`: `Initial Sequence Number`, 初始序列号
